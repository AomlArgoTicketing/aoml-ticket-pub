name: Sync Public Issues to Private Repo

on:
  issues:
    types: [opened]

jobs:
  sync_issue:
    runs-on: ubuntu-latest
    steps:
      - name: Create Internal Issue
        uses: actions/github-script@v6
        with:
          github-token: ${{ secrets.PAT_SECRET }}
          script: |
            const issue = context.payload.issue;
            const title = issue.title;
            const body = issue.body;
            const public_url = issue.html_url;

            github.issues.create({
              owner: 'TicketTesting77',
              repo: 'aoml-internal-tracking',
              title: `[Public #${issue.number}] ${title}`,
              body: `**Public Issue:** [View Issue](${public_url})\n\n${body}`,
              labels: ["Synced from Public"]
            });

            // Post a comment in the public issue
            github.issues.createComment({
              issue_number: issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: "Thanks for your submission. We have logged this internally for review."
            });
